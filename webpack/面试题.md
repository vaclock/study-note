
### 异步导入
```js
import('./xxx.js') // 会导入xxx.js并且执行xxx.js
```

### webpack5更新
1. 清除输出目录开箱可用 无须安装clean-webpack-plugin 具体做法
```js
{
    output: {
        clean: true
    }
}
```
2. 联邦模块: 为了解决微前端中的一些场景 -> 不同的页面(项目)如何共享代码(共享资源)
```js
// 暴露模块
const webpackFederationPlugin = require('webpack/lib/container/ModuleFederationPlugin')
module.exports = {
    //...
    plugins: [
        // 模块提供
        new webpackFederationPlugin({
            name: 'home', // 模块联邦的命名
            filename: 'home-entry.js'
            exposes: {
                // key: 相对于模块联邦的路径 value: 本项目中的路径 之后其他项目引用该模块使用import('home/now')
                './now': 'src/now.js'
            }
        })
    ]
}
```
```js
// 使用模块
const webpackFederationPlugin = require('webpack/lib/container/ModuleFederationPlugin')
module.exports = {
    //...
    plugins: [
        // 模块提供
        new webpackFederationPlugin({
            remotes: {
                // key可以自定义(别名)
                // 使用远程模块时使用 import now from 'home/now'
                home: 'home@ip:port/home-entry.js'
            }
        })
    ]
}

// 最终使用
// xxx.js
import now from 'home/now'
```
```js
// 共享模块
const webpackFederationPlugin = require('webpack/lib/container/ModuleFederationPlugin')
module.exports = {
    //...
    plugins: [
        // 模块提供
        new webpackFederationPlugin({
           shared: {
            jquery: {
                singleton: true //全局唯一
            }
           }
        })
    ]
}
```
3. top-level-await: 允许在模块顶部直接使用await
```js
module.exports = {
  //...
  experiments: {
    topLevelAwait: true
  }
}
```
1. 打包体积优化: 对模块的合并、作用域提升、tree-shaking等处理更加智能
合并一些复杂的模块依赖关系
1. 打包缓存开箱即用: 在webpack4中 需要使用cache-loader, webpack5中 默认缓存在内存中
```js
module.exports = {
    cache: {
        type: 'filesystem' // 默认memory
        cacheDirectory: path.resolve(__dirname, 'node_modules/.cache/webpack')
    }
}
```
1. 资源模块: 在webpack4中 针对资源模块通常使用file-loader、url-loader、raw-loader等进行处理 webpack5支持资源模块
```js
module.exports = {
    output: {
        //...
        assetModuleFilename: 'assets/[hash:5][ext]', // 定义资源保存的路径
    },
    module: {
        rules: [
            {
                test: /\.png/,
                type: 'asset/resource' // 作用类型file-loader
            },
            {
                test: /\.jpg/,
                type: 'asset/inline' // 作用类型url-loader 文件大小不足的场景
            },
            {
                test: /\.txt/,
                type: 'asset/source' // 作用类型raw-loader
            },
            {
                test: /\.gif/,
                type: 'asset',
                generator: {
                    filename: 'gif/[hash:5][ext]' // 会覆盖上方的assetsModuleFilename的配置
                },
                parser: {
                    dataUrlCondition: {
                        maxSize: 4 * 1024 // 4kb以下使用data uri
                    }
                }
            }
        ]
    }
}
```